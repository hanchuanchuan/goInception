(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{444:function(t,_,v){"use strict";v.r(_);var s=v(44),e=Object(s.a)({},(function(){var t=this,_=t.$createElement,v=t._self._c||_;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"调用选项"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#调用选项"}},[t._v("#")]),t._v(" 调用选项")]),t._v(" "),v("h4",{attrs:{id:"使用示例"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#使用示例"}},[t._v("#")]),t._v(" 使用示例")]),t._v(" "),v("p",[t._v("goInception延用inception的使用方式，在审核的sql开始前添加注释来指定远端服务器，并在sql的前后添加特殊标识以区分待审核语句，示例如下：")]),t._v(" "),v("div",{staticClass:"language-sql extra-class"},[v("pre",{pre:!0,attrs:{class:"language-sql"}},[v("code",[v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*--user=root;--password=root;--host=127.0.0.1;--check=1;--port=3306;*/")]),t._v("\ninception_magic_start"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" test"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" t1"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("primary")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("key")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ninception_magic_commit"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),v("h3",{attrs:{id:"选项列表"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#选项列表"}},[t._v("#")]),t._v(" 选项列表")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("参数")]),t._v(" "),v("th",[t._v("默认值")]),t._v(" "),v("th",[t._v("数据类型")]),t._v(" "),v("th",[t._v("说明")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("host")]),t._v(" "),v("td",[t._v("''")]),t._v(" "),v("td",[t._v("string")]),t._v(" "),v("td",[t._v("线上数据库IP地址")])]),t._v(" "),v("tr",[v("td",[t._v("port")]),t._v(" "),v("td",[t._v("0")]),t._v(" "),v("td",[t._v("int")]),t._v(" "),v("td",[t._v("线上数据库端口")])]),t._v(" "),v("tr",[v("td",[t._v("user")]),t._v(" "),v("td",[t._v("''")]),t._v(" "),v("td",[t._v("string")]),t._v(" "),v("td",[t._v("线上数据库用户名")])]),t._v(" "),v("tr",[v("td",[t._v("password")]),t._v(" "),v("td",[t._v("''")]),t._v(" "),v("td",[t._v("string")]),t._v(" "),v("td",[t._v("线上数据库密码")])]),t._v(" "),v("tr",[v("td",[t._v("db "),v("code",[t._v("v1.1.0")])]),t._v(" "),v("td",[t._v('"mysql"')]),t._v(" "),v("td",[t._v("string")]),t._v(" "),v("td",[t._v("默认连接的数据库。该参数可忽略，即使用默认数据库"),v("code",[t._v("mysql")]),t._v('。可设置为空""。')])]),t._v(" "),v("tr",[v("td",[t._v("check")]),t._v(" "),v("td",[t._v("false")]),t._v(" "),v("td",[t._v("bool")]),t._v(" "),v("td",[t._v("开启审核功能。开启后，执行选项不再生效")])]),t._v(" "),v("tr",[v("td",[t._v("execute")]),t._v(" "),v("td",[t._v("false")]),t._v(" "),v("td",[t._v("bool")]),t._v(" "),v("td",[t._v("开启执行功能")])]),t._v(" "),v("tr",[v("td",[t._v("backup")]),t._v(" "),v("td",[t._v("false")]),t._v(" "),v("td",[t._v("bool")]),t._v(" "),v("td",[t._v("开启备份功能，仅在执行时生效")])]),t._v(" "),v("tr",[v("td",[t._v("ignore_warnings")]),t._v(" "),v("td",[t._v("false")]),t._v(" "),v("td",[t._v("bool")]),t._v(" "),v("td",[t._v("是否忽略警告，仅在执行时生效。该参数控制有警告时是继续执行还是中止")])]),t._v(" "),v("tr",[v("td",[t._v("trans "),v("code",[t._v("v1.1.6")])]),t._v(" "),v("td",[t._v("0")]),t._v(" "),v("td",[t._v("int")]),t._v(" "),v("td",[t._v("单个事务包含的DML条数。当设置>1时，则开启事务，按设置条数提交。如设为500，则会500条DML提交一次。详见**"),v("RouterLink",{attrs:{to:"/zh/trans.html"}},[t._v("事务功能")]),t._v("**")],1)]),t._v(" "),v("tr",[v("td",[t._v("fingerprint "),v("code",[t._v("v0.6.2")])]),t._v(" "),v("td",[t._v("false")]),t._v(" "),v("td",[t._v("bool")]),t._v(" "),v("td",[t._v("开启sql指纹功能。dml语句相似时，可以根据相同的指纹ID复用explain结果，减少远端数据库explain操作，以提高审核速度")])]),t._v(" "),v("tr",[v("td",[t._v("masking "),v("code",[t._v("v1.2.5")])]),t._v(" "),v("td",[t._v("false")]),t._v(" "),v("td",[t._v("bool")]),t._v(" "),v("td",[t._v("新版的打印SQL语法树，返回JSON格式结果。"),v("a",{attrs:{href:"https://github.com/hanchuanchuan/goInception/pull/355",target:"_blank",rel:"noopener noreferrer"}},[t._v("更多信息"),v("OutboundLink")],1)])]),t._v(" "),v("tr",[v("td",[t._v("query-print "),v("code",[t._v("v0.7.1")])]),t._v(" "),v("td",[t._v("false")]),t._v(" "),v("td",[t._v("bool")]),t._v(" "),v("td",[t._v("打印SQL语法树，返回JSON格式结果，详见**"),v("RouterLink",{attrs:{to:"/zh/tree.html"}},[t._v("语法树打印")]),t._v("**")],1)]),t._v(" "),v("tr",[v("td",[t._v("split "),v("code",[t._v("v0.9.1")])]),t._v(" "),v("td",[t._v("false")]),t._v(" "),v("td",[t._v("bool")]),t._v(" "),v("td",[t._v("将一段SQL语句按互不影响原则分组DDL和DML语句，即相同表的DDL及DML语句分开两个语句块执行。指定后，其他选项(审核、执行、备份、打印语法树等)均不再生效。兼容老版inception，实际情况下 "),v("strong",[t._v("可以不分组")]),t._v("，goInception记录有表结构快照，用以实现binlog解析。"),v("a",{attrs:{href:"https://github.com/hanchuanchuan/goInception/pull/42",target:"_blank",rel:"noopener noreferrer"}},[t._v("更多信息"),v("OutboundLink")],1)])]),t._v(" "),v("tr",[v("td",[t._v("sleep "),v("code",[t._v("v1.0-rc3")])]),t._v(" "),v("td",[t._v("0")]),t._v(" "),v("td",[t._v("int")]),t._v(" "),v("td",[t._v("执行 "),v("code",[t._v("sleep_rows")]),t._v(" 条SQL后休眠多少毫秒，用以降低对线上数据库的影响。单位为毫秒，最小值为 "),v("code",[t._v("0")]),t._v(" ，即不设置，最大值为 "),v("code",[t._v("100000")]),t._v("，即100秒。默认值 "),v("code",[t._v("0")])])]),t._v(" "),v("tr",[v("td",[t._v("sleep_rows "),v("code",[t._v("v1.0-rc3")])]),t._v(" "),v("td",[t._v("1")]),t._v(" "),v("td",[t._v("int")]),t._v(" "),v("td",[t._v("执行多少条SQL后休眠一次。最小值为 "),v("code",[t._v("1")]),t._v("，默认值 "),v("code",[t._v("1")])])]),t._v(" "),v("tr",[v("td",[t._v("real_row_count "),v("code",[t._v("v1.0.3")])]),t._v(" "),v("td",[t._v("false")]),t._v(" "),v("td",[t._v("bool")]),t._v(" "),v("td",[t._v("设置是否通过count(*)获取真正受影响行数(DML操作).默认值 "),v("code",[t._v("false")]),t._v(" (开启时忽略 "),v("code",[t._v("fingerprint")]),t._v("sql指纹功能设置,准确性优先)")])])])]),t._v(" "),v("h3",{attrs:{id:"mysql加密连接设置"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#mysql加密连接设置"}},[t._v("#")]),t._v(" mysql加密连接设置")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("参数")]),t._v(" "),v("th",[t._v("默认值")]),t._v(" "),v("th",[t._v("数据类型")]),t._v(" "),v("th",[t._v("说明")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("ssl")]),t._v(" "),v("td",[t._v("DISABLED")]),t._v(" "),v("td",[t._v("string")]),t._v(" "),v("td",[t._v("ssl-mode设置，参数和mysql的--ssl-mode一致")])]),t._v(" "),v("tr",[v("td",[t._v("ssl-ca")]),t._v(" "),v("td"),t._v(" "),v("td",[t._v("string")]),t._v(" "),v("td",[t._v("证书颁发机构（CA）证书文件的路径名（PEM格式）")])]),t._v(" "),v("tr",[v("td",[t._v("ssl-cert")]),t._v(" "),v("td"),t._v(" "),v("td",[t._v("string")]),t._v(" "),v("td",[t._v("SSL公钥证书文件的路径名（PEM格式）")])]),t._v(" "),v("tr",[v("td",[t._v("ssl-key")]),t._v(" "),v("td"),t._v(" "),v("td",[t._v("string")]),t._v(" "),v("td",[t._v("SSL私钥文件的路径名（PEM格式）")])])])]),t._v(" "),v("h4",{attrs:{id:"ssl类型说明"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#ssl类型说明"}},[t._v("#")]),t._v(" ssl类型说明")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("类型")]),t._v(" "),v("th",[t._v("说明")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("DISABLED "),v("code",[t._v("默认值")])]),t._v(" "),v("td",[t._v("禁用TLS")])]),t._v(" "),v("tr",[v("td",[t._v("PREFERRED")]),t._v(" "),v("td",[t._v("由服务器发布时使用TLS")])]),t._v(" "),v("tr",[v("td",[t._v("REQUIRED")]),t._v(" "),v("td",[t._v("使用TLS，但不检查CA证书")])]),t._v(" "),v("tr",[v("td",[t._v("VERIFY_CA")]),t._v(" "),v("td",[t._v("验证CA证书，但忽略主机名不匹配")])]),t._v(" "),v("tr",[v("td",[t._v("VERIFY_IDENTITY")]),t._v(" "),v("td",[t._v("验证CA证书")])])])]),t._v(" "),v("h5",{attrs:{id:"ca证书认证示例"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#ca证书认证示例"}},[t._v("#")]),t._v(" CA证书认证示例")]),t._v(" "),v("div",{staticClass:"language-python extra-class"},[v("pre",{pre:!0,attrs:{class:"language-python"}},[v("code",[v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过ssl=verify_ca设置CA证书验证")]),t._v("\n"),v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 需要把证书放在goInception服务同主机上")]),t._v("\nsql "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v("'''/*--user=test;--password=xxx;--host=127.0.0.1;--port=3333;--check=1;\\\n--ignore-warnings=1;--ssl=verify_ca;\\\n--ssl-ca=/data/mysql/data/ca.pem;\\\n--ssl-cert=/data/mysql/data/client-cert.pem;\\\n--ssl-key=/data/mysql/data/client-key.pem;*/\ninception_magic_start;\nuse test_inc;\n...\ninception_magic_commit;'''")]),t._v("\n")])])]),v("h5",{attrs:{id:"ssl认证认证示例"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#ssl认证认证示例"}},[t._v("#")]),t._v(" ssl认证认证示例")]),t._v(" "),v("div",{staticClass:"language-python extra-class"},[v("pre",{pre:!0,attrs:{class:"language-python"}},[v("code",[v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过ssl=verify_ca设置CA证书验证")]),t._v("\n"),v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 需要把证书放在goInception服务同主机上")]),t._v("\nsql "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v("'''/*--user=test;--password=xxx;--host=127.0.0.1;--port=3333;--check=1;\\\n--ignore-warnings=1;--ssl=required;*/\ninception_magic_start;\nuse test_inc;\n...\ninception_magic_commit;'''")]),t._v("\n")])])])])}),[],!1,null,null,null);_.default=e.exports}}]);